javascript:(async() => {const Wait = {waits : [],num : -1,add(){return new Promise((resolve) =>{this.num++;this.waits[this.num] = resolve;});},release(){this.waits[this.num]();this.waits[this.num] = "";this.num--;},time(sec){return new Promise((resolve) =>{setTimeout(function(){resolve();}, sec * 1000);});},};const REFF = "https://minesweeper.online";const TAR_URL = "https://minesweeper.online/ja/economy";const TAR_TITLE = "ã‚²ãƒ¼ãƒ å†…çµŒæ¸ˆç”»é¢";if(location.href.includes(REFF)){}else{if(!location.href.includes(TAR_URL)){const result = window.confirm(`${TAR_TITLE}ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚\n${TAR_TITLE}ã¸é£›ã³ã¾ã™ã‹ï¼Ÿ\nï¼ˆãƒšãƒ¼ã‚¸é·ç§»å¾Œã«å†åº¦ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚ï¼‰`);if(result){location.href = TAR_URL;}else{alert(`${TAR_TITLE}ï¼ˆ${TAR_URL}ï¼‰ã‚’è¡¨ç¤ºã•ã›ã¦ãã ã•ã„ã€‚`);}return;}}let parentPage = null;if(location.href.includes(TAR_URL)){main(document);}else{parentPage = document.createElement("div");parentPage.addEventListener("click", async() => {parentPage.remove();observer?.disconnect();});parentPage.textContent = "é–‰ã˜ã‚‹";parentPage.style = "position: fixed; top: 0px; left: 0px; height: 100vh; width: 100vw; z-index: 9999; background-color: rgba(0, 0, 0, 0.5); margin: 10px;";const iframe = document.createElement("iframe");iframe.setAttribute("src", TAR_URL);iframe.style = "height: 100%; width: 100%;";parentPage.append(iframe);document.body.append(parentPage);iframe.addEventListener("load", () => {const target = iframe.contentWindow.document.body;const observer = new MutationObserver(function (mutations) {const tar = mutations[0].target;if(tar.id === "richest_coins_price"){observer.disconnect();main(iframe.contentWindow.document);}});observer.observe(target, {attributes: true,/*å±æ€§å¤‰åŒ–ã®ç›£è¦–*/characterData: true,/*ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®å¤‰åŒ–ã‚’ç›£è¦–*/childList: true,/*å­ãƒãƒ¼ãƒ‰ã®å¤‰åŒ–ã‚’ç›£è¦–*/subtree: true,/*å­å­«ãƒãƒ¼ãƒ‰ã‚‚ç›£è¦–å¯¾è±¡ã«å«ã‚ã‚‹*/});});}async function main(document){/*â– åˆæœŸå‡¦ç†*/const EXTRACTIONS = [["ãƒˆãƒ‘ãƒ¼ã‚º", 1],["ãƒ«ãƒ“ãƒ¼", 2],["ã‚µãƒ•ã‚¡ã‚¤ã‚¢", 3],["ã‚¢ãƒ¡ã‚¸ã‚¹ãƒˆ", 4],["ã‚ªãƒ‹ã‚­ã‚¹", 5],["ã‚¢ã‚¯ã‚¢ãƒãƒªãƒ³", 6],["ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰", 7],["ã‚¬ãƒ¼ãƒãƒƒãƒˆ", 8],["ç¿¡ç¿ ", 9],["ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰", 10],["å¹³å‡", 0],];const today = new Date();if(today.getHours() < 9){/*æ—¥åº¦ã¯09:00ã‹ã‚‰å§‹ã¾ã‚‹*/today.setDate(today.getDate() - 1);}const dateStr = `${today.getMonth() + 1}/${today.getDate()}`;let isLooping = true;const bk = document.createElement("div");bk.style = "position:fixed; top: 0px; left: 0px; background-color: rgba(0, 0, 0, 0.5); width: 100vw; height: 100vh; font-size: 2em; z-index: 100; display: flex; justify-content: center; align-items: center; flex-direction: column;";bk.innerHTML = "";bk.innerText = `${dateStr}ã®å®çŸ³ãƒ¬ãƒ¼ãƒˆã‚’å–å¾—ã—ã¦ã„ã¾ã™â€¦\nã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„â€¦`;const breakButton = document.createElement("button");breakButton.type = "button";breakButton.textContent = "çµ‚äº†ã™ã‚‹";breakButton.addEventListener("click", () => {isLooping = false;observer.disconnect();bk.remove();});bk.append(breakButton);const progress = document.createElement("progress");progress.max = EXTRACTIONS.length;progress.value = 0;bk.append(progress);{const label = document.createElement("label");label.style = "cursor: pointer;";bk.append(label);const chkShowHeader = document.createElement("input");chkShowHeader.type = "checkbox";chkShowHeader.checked = false;chkShowHeader.id = "_chkShowHeader";chkShowHeader.style = "transform: scale(1.5); margin: 5px;";label.append(chkShowHeader);const span = document.createElement("span");span.textContent = "è¦‹å‡ºã—ã‚‚å–å¾—ã™ã‚‹";span.style = "font-size: 16px";label.append(span);}{const label = document.createElement("label");label.style = "cursor: pointer;";bk.append(label);const chkShowHeader = document.createElement("input");chkShowHeader.type = "checkbox";chkShowHeader.checked = true;chkShowHeader.id = "_chkCopyDataWhenJumpToSheet";chkShowHeader.style = "transform: scale(1.5); margin: 5px;";label.append(chkShowHeader);const span = document.createElement("span");span.textContent = "ã‚·ãƒ¼ãƒˆé·ç§»æ™‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹";span.style = "font-size: 16px";label.append(span);}document.body.append(bk);/*â– ãƒ‡ãƒ¼ã‚¿å–å¾—*/const putDatas = [];putDatas.push(dateStr);const VAILD_DATA_STR = "XXXXX";let i = 0;const target = document.body;/*æœ¬æ¥ãªã‚‰tableã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ãŸã„ãŒã€ãƒ†ãƒ¼ãƒ–ãƒ«ãã®ã‚‚ã®ã‚’æ›¸ãæ›ãˆã¦ã„ã‚‹ã®ã§bodyã‹ã‚‰å–å¾—*/const observer = new MutationObserver(function (mutations) {const tar = mutations[0].target;if(tar.id === "EconomyBlock"){const td = tar.querySelector(":scope > table > tbody > tr:nth-of-type(2) > td:nth-of-type(2)");const observer = new MutationObserver(function (mutations) {const tar = mutations[0].target;putDatas[i + 1] = tar.textContent || VAILD_DATA_STR;Wait.release();observer.disconnect();});observer.observe(td, {characterData: true,/*ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®å¤‰åŒ–ã‚’ç›£è¦–*/childList: true,/*å­ãƒãƒ¼ãƒ‰ã®å¤‰åŒ–ã‚’ç›£è¦–*/subtree: true,/*å­å­«ãƒãƒ¼ãƒ‰ã‚‚ç›£è¦–å¯¾è±¡ã«å«ã‚ã‚‹*/});}});observer.observe(target, {attributes: true,/*å±æ€§å¤‰åŒ–ã®ç›£è¦–*/characterData: true,/*ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã®å¤‰åŒ–ã‚’ç›£è¦–*/childList: true,/*å­ãƒãƒ¼ãƒ‰ã®å¤‰åŒ–ã‚’ç›£è¦–*/subtree: true,/*å­å­«ãƒãƒ¼ãƒ‰ã‚‚ç›£è¦–å¯¾è±¡ã«å«ã‚ã‚‹*/});const Wait = {waits : [],num : -1,add(){return new Promise((resolve) =>{this.num++;this.waits[this.num] = resolve;});},release(){this.waits[this.num]();this.waits[this.num] = "";this.num--;},time(sec){return new Promise((resolve) =>{setTimeout(function(){resolve();}, sec * 1000);});},};while(isLooping){const jemname = EXTRACTIONS[i][0];const jemargu = EXTRACTIONS[i][1];await Wait.time(1);document.querySelectorAll("#EconomyBlock table:nth-of-type(1) > tbody > tr:nth-child(2) > td:nth-of-type(1) ul > li > a")[jemargu].click();/*ãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ãƒ»awaitã®è§£æ±ºã¯observerã§ãŠã“ãªã†*/await Wait.add();i++;progress.value = i;if(i === EXTRACTIONS.length){break;}}observer.disconnect();/*â– ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º*/const isShowHeader = document.getElementById("_chkShowHeader").checked;const isCopyDataWhenJumpToSheet = document.getElementById("_chkCopyDataWhenJumpToSheet").checked;bk.innerHTML = "";const textarea = document.createElement("textarea");if(isShowHeader){textarea.value += "æ—¥ä»˜\t";textarea.value += EXTRACTIONS.map((arr) => arr[0]).join("\t");textarea.value += "\n";}textarea.value += putDatas.join("\t");textarea.style = "font-size: 16px; width: 90%; height: 50%;";bk.append(textarea);const wrapper = document.createElement("div");wrapper.style = "height: 20%; width: 90%; font-size: 16px; display: grid; grid-template-columns: repeat(2, 1fr); grid-template-rows: repeat(2, 1fr); gap: 0px;";bk.append(wrapper);const copyButton = document.createElement("button");copyButton.type = "button";copyButton.textContent = "ğŸ“ƒã‚³ãƒ”ãƒ¼ã™ã‚‹";copyButton.addEventListener("click", () => {textarea.select();document.execCommand("copy");window.getSelection?.().removeAllRanges();textarea.blur();copyButton.textContent = "ğŸ“ƒã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼";setTimeout(() => {copyButton.textContent = "ğŸ“ƒã‚³ãƒ”ãƒ¼ã™ã‚‹";}, 3000);});copyButton.style = "grid-column: span 2 / span 2;";wrapper.append(copyButton);const closeButton = document.createElement("button");closeButton.type = "button";closeButton.textContent = "é–‰ã˜ã‚‹";closeButton.addEventListener("click", () => {bk.remove();if(parentPage){parentPage.remove();}});closeButton.style = "grid-column-start: 1; grid-row-start: 2;";wrapper.append(closeButton);const jumpButton = document.createElement("button");jumpButton.type = "button";jumpButton.style = "grid-column-start: 2; grid-row-start: 2;";wrapper.append(jumpButton);const anc = document.createElement("a");anc.innerText = "ã‚³ãƒ”ãƒšã—ã«ã„ã\nï¼ˆã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸é£›ã³ã¾ã™ï¼‰";anc.href = "https://docs.google.com/spreadsheets/d/1FgpjiyNmgBRkSSh9dH7BykKiNvOFu5-yATCETNO4pt4/edit?gid=0#gid=0";anc.setAttribute("target", '_blank');if(isCopyDataWhenJumpToSheet){anc.addEventListener("click", () => {textarea.select();document.execCommand("copy");window.getSelection?.().removeAllRanges();textarea.blur();});}anc.style = "display: block;";jumpButton.append(anc);{let str = "";for(let i = 0; i < putDatas.length; i++){if(putDatas[i] === VAILD_DATA_STR){str += `${EXTRACTIONS[i][0]}\n`;}}if(str){alert(`æ¬¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚\n${str}`);}}}/*ãã“ã§æ€ã£ãŸã®ã§ã™ãŒã€å®çŸ³ãƒ¬ãƒ¼ãƒˆã‚’å–å¾—ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’MSOã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«è¿½åŠ ã—ã¦ã—ã¾ã†ã®ã¯ã©ã†ã§ã—ã‚‡ã†ã‹ï¼Ÿã“ã†ã™ã‚Œã°ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ã„ã¡ã„ã¡å®Ÿè¡Œã—ãªãã¦æ¸ˆã¿ã¾ã™ï¼ˆãŸã ã€MSOã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ãŒçŸ­æ‰€â€¦ï¼‰ã€‚nagaoã•ã‚“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨åŒã˜ã‚ˆã†ãªã“ã¨ã‚’ã™ã‚Œã°å®Ÿç¾ã§ãã‚‹ã¨ç®—æ®µã—ã¦ãŠã‚Šã¾ã™ã€‚*/})();
