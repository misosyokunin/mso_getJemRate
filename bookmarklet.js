javascript:(async() => {"use strict";/*┏━━━━━━━━━━━━━━━━━━━━━┓┃ＭＳＯ＿宝石相場を取得（日次）：akimさん用┃┗━━━━━━━━━━━━━━━━━━━━━┛Developer:魚頭男（https://minesweeper.online/ja/player/16842796）Writing:魚頭男（https://minesweeper.online/ja/player/16842796）宝石の相場データを毎日取得するのは面倒。というわけで、クローラーを作りました。=======================================================このツールはMinesweeper.Online様（https://minesweeper.online/、以下「ＭＳＯ」）より公認を受けていない、非公認のものです。当プログラムは、ＭＳＯ様とは一切関係ございませんので、このプログラムに関する質問・提言等の連絡は魚頭男（https://minesweeper.online/ja/player/16842796、以下「魚」）までお願いします。当プログラムについて、ＭＳＯ様に連絡することは絶対にしないでください。運営者様並びにユーザー様にご迷惑にならないように努めておりますが、万が一のことがありましたら即削除いたします。=======================================================*//*＝＝＝＝＝＝＝＝＝【使い方】＝＝＝＝＝＝＝＝＝https://minesweeper.online/ja/economyへ飛び、このスクリプトを実行。あとは身を任せるだけです。1ページ辺り2秒ペースで取得します（1秒ペースですとロードが終わらないことがあったので）。（また、中断機能を設けておりますので、無謀な実行でも大丈夫です）。スクリプト実行中は、できるだけタブの遷移やブラウザをバックグラウンドにしないようにしてください。なお、他言語でも同じようなことができると思います。ただ、このスクリプトのままでは動きませんので、適宜変えてください（「ja」や抽出文言）。*/if(!location.href.includes("https://minesweeper.online/ja/economy")){alert("ゲーム内経済画面を表示させてください。");return;}const EXTRACTIONS = [["トパーズ", 1],["ルビー", 2],["サファイア", 3],["アメジスト", 4],["オニキス", 5],["アクアマリン", 6],["エメラルド", 7],["ガーネット", 8],["翡翠", 9],["ダイヤモンド", 10],["平均", 0],];const bk = document.createElement("div");bk.style = "position:fixed; top: 0px; left: 0px; background-color: rgba(0, 0, 0, 0.5); width: 100vw; height: 100vh; font-size: 2em; z-index: 100; display: flex; justify-content: center; align-items: center; flex-direction: column;";bk.innerHTML = "";bk.innerText = "宝石レート取得中…\nしばらくお待ちください…";const breakButton = document.createElement("button");breakButton.type = "button";breakButton.textContent = "終了する";breakButton.addEventListener("click", () => {isLooping = false;bk.remove();});bk.append(breakButton);document.body.append(bk);let isLooping = true;const putDatas = [];const VAILD_DATA_STR = "XXXXX";let i = 0;while(isLooping){const jemname = EXTRACTIONS[i][0];const jemargu = EXTRACTIONS[i][1];document.querySelectorAll("#EconomyBlock table:nth-of-type(1) > tbody > tr:nth-child(2) > td:nth-of-type(1) ul > li > a")[jemargu].click();await new Promise(resolve => setTimeout(resolve, 2000));/*★1000未満にしちゃダメ！！！*/putDatas[i] = document.querySelector("#EconomyBlock table:nth-of-type(1) > tbody > tr:nth-child(2) > td:nth-of-type(2)").textContent || VAILD_DATA_STR;i++;if(i === EXTRACTIONS.length){break;}}bk.innerHTML = "";const textarea = document.createElement("textarea");textarea.value += putDatas.join("\t");textarea.style = "font-size: 16px; width: 90%; height: 80%;";bk.append(textarea);const wrapper = document.createElement("div");wrapper.style = "display: flex; font-size: 16px;";bk.append(wrapper);const closeButton = document.createElement("button");closeButton.type = "button";closeButton.textContent = "閉じる";closeButton.addEventListener("click", () => {bk.remove();});closeButton.style = "width: 100%;";wrapper.append(closeButton);const jumpButton = document.createElement("button");jumpButton.type = "button";jumpButton.textContent = "コピペしにいく\n（スプレッドシートへ飛びます）";jumpButton.addEventListener("click", () => {const url = "https://docs.google.com/spreadsheets/d/1FgpjiyNmgBRkSSh9dH7BykKiNvOFu5-yATCETNO4pt4/edit?gid=0#gid=0";window.open(url, '_blank');});jumpButton.style = "width: 100%;";wrapper.append(jumpButton);{let str = "";for(let i = 0; i < putDatas.length; i++){if(putDatas[i] === VAILD_DATA_STR){str += `${EXTRACTIONS[i][0]}\n`;}}if(str){alert(`次のデータを取得できませんでした。\n${str}`);}}textarea.focus();textarea.select();document.execCommand("copy");})();
